<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Produtos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="cadprodutos.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            
            <nav class="sidebar-menu">
                <ul>
                    <li>
                        <a href="dashboard.html">
                            <i class="fas fa-home"></i>
                            <span>Início</span>
                        </a>
                    </li>
                    <li>
                        <a href="cadprodutos.html" class="active">
                            <i class="fas fa-box"></i>
                            <span>Cadastrar Produtos</span>
                        </a>
                    </li>
                    <li>
                        <a href="cardapio.html">
                            <i class="fas fa-book-open"></i>
                            <span>Cardápio Online</span>
                        </a>
                    </li>
                    <li>
                        <a href="vendas-dia.html">
                            <i class="fas fa-shopping-cart"></i>
                            <span>Vendas do Dia</span>
                        </a>
                    </li>
                    <li>
                        <a href="settings.html">
                            <i class="fas fa-cog"></i>
                            <span>Configurações</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <!-- Seção de Estatísticas - NOVA POSIÇÃO -->
            <div class="stats-section">
                <div class="stats-container">
                    <!-- Card de Produtos Ativos -->
                    <div class="stat-card">
                        <div class="stat-icon active">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="produtosAtivos">0</span>
                            <span class="stat-label">Produtos Ativos</span>
                        </div>
                    </div>
                    
                    <!-- Card de Baixo Estoque -->
                    <div class="stat-card">
                        <div class="stat-icon stock">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="produtosEstoque">0</span>
                            <span class="stat-label">Baixo Estoque</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Botão Voltar (mantido conforme solicitado) -->
            <div class="sidebar-footer">
                <button class="btn-voltar-simples" id="btnVoltarDashboard">
                    <i class="fas fa-arrow-left"></i>
                    <span>Voltar</span>
                </button>
            </div>
        </aside>

        <!-- Conteúdo Principal -->
        <main class="main-content">
            <!-- Header com Estatísticas - REMOVIDO -->
            <header class="main-header">
                <div class="header-content">
                    <h1 class="page-title">Cadastrar Novo Produto</h1>
                </div>

                <div class="header-actions">
                    <div class="search-wrapper">
                        <input type="text" id="searchInput" placeholder="Buscar produto...">
                    </div>
                    <button class="btn-action" id="btnAtualizar">
                        <i class="fas fa-sync-alt"></i>
                        Atualizar
                    </button>
                </div>
            </header>

            <!-- Layout Principal -->
            <div class="content-wrapper">
                <!-- Formulário -->
                <section class="form-section">
                    <div class="section-header">
                        <h2><i class="fas fa-edit"></i> Informações do Produto</h2>
                        <div class="form-status">
                            <span class="status-label">Status no Cardapio:</span>
                            <label class="switch">
                                <input type="checkbox" id="statusProduto" checked>
                                <span class="slider"></span>
                            </label>
                            <span class="status-text active" id="statusText">Ativo</span>
                        </div>
                    </div>

                    <form id="produtoForm" class="product-form">
                        <!-- Linha 1: Nome e Categoria -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="nomeProduto" class="form-label">
                                    <i class="fas fa-tag"></i>
                                    Nome do Produto *
                                </label>
                                <input type="text" id="nomeProduto" required placeholder="Digite o nome do produto">
                                <div class="form-hint">Ex: Pizza Marguerita Premium</div>
                            </div>

                            <div class="form-group" id="categoriaContainer">
                                <label for="categoriaProduto" class="form-label">
                                    <i class="fas fa-layer-group"></i>
                                    Categoria
                                </label>
                                <div class="select-wrapper">
                                    <select id="categoriaProduto">
                                        <!-- Categorias serão carregadas dinamicamente -->
                                    </select>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Linha 1.5: Peso/Tamanho e Sabores -->
                        <div class="form-row" id="pesoContainer">
                            <div class="form-group">
                                <label for="pesoProduto" class="form-label">
                                    <i class="fas fa-weight-hanging"></i>
                                    Peso/Tamanho (opcional)
                                </label>
                                <div class="select-wrapper">
                                    <select id="pesoProduto">
                                        <option value="">Não especificado</option>
                                        <!-- Pesos serão carregados dinamicamente -->
                                    </select>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <p class="form-hint">Selecione um peso/tamanho pré-definido</p>
                            </div>
                            
                            <div class="form-group">
                                <label for="saboresProduto" class="form-label">
                                    <i class="fas fa-pizza-slice"></i>
                                    Quantidade de Sabores (opcional)
                                </label>
                                <div class="select-wrapper">
                                    <select id="saboresProduto">
                                        <option value="1">1 sabor</option>
                                        <option value="2">2 sabores</option>
                                        <option value="3">3 sabores</option>
                                        <option value="4">4 sabores</option>
                                    </select>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <p class="form-hint">Defina quantos sabores este produto permite</p>
                            </div>
                        </div>

                        <!-- Linha 2: Descrição -->
                        <div class="form-group" id="descricaoContainer">
                            <label for="descricaoProduto" class="form-label">
                                <i class="fas fa-align-left"></i>
                                Descrição
                            </label>
                            <textarea id="descricaoProduto" rows="9" placeholder="Descreva o produto em detalhes..."></textarea>
                        </div>

                        <!-- Linha 3: Tipo e Preço -->
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-cube"></i>
                                    Tipo do Produto
                                </label>
                                <div class="type-buttons">
                                    <button type="button" class="type-btn active" data-type="normal">
                                        <i class="fas fa-box"></i>
                                        <span>Normal</span>
                                        <small>Produto principal</small>
                                    </button>
                                    <button type="button" class="type-btn" data-type="adicional">
                                        <i class="fas fa-plus-circle"></i>
                                        <span>Adicional</span>
                                        <small>Item extra</small>
                                    </button>
                                </div>
                                <input type="hidden" id="tipoProduto" value="normal">
                            </div>

                            <div class="form-group">
                                <label for="precoProduto" class="form-label">
                                    <i class="fas fa-dollar-sign"></i>
                                    Preço (R$)
                                </label>
                                <div class="input-with-icon">
                                    <span class="input-icon">R$</span>
                                    <input type="number" id="precoProduto" min="0" step="0.01" placeholder="0.00">
                                </div>
                            </div>
                        </div>

                        <!-- Linha 4: Estoque e Imagem -->
                        <div class="form-row">
                            <div class="form-group" id="estoqueContainer">
                                <label for="quantidadeEstoque" class="form-label">
                                    <i class="fas fa-boxes"></i>
                                    Estoque Disponível
                                </label>
                                <div class="stock-input">
                                    <input type="number" id="quantidadeEstoque" min="0" value="0">
                                    <div class="stock-indicator">
                                        <div class="stock-progress">
                                            <div class="stock-bar" id="stockBar"></div>
                                        </div>
                                        <span class="stock-text">Nível: <span id="stockLevel">Bom</span></span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group" id="imagemContainer">
                                <label for="imagemURL" class="form-label">
                                    <i class="fas fa-image"></i>
                                    URL da Imagem
                                </label>
                                <div class="url-input">
                                    <input type="url" id="imagemURL" placeholder="https://exemplo.com/imagem.jpg">
                                    <button type="button" class="btn-preview" id="btnPreviewImagem">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="form-hint">URL opcional para imagem do produto</div>
                            </div>
                        </div>

                        <!-- Categorias para Adicionais -->
                        <div class="form-group" id="categoriasAdicionaisContainer" style="display: none;">
                            <label class="form-label">
                                <i class="fas fa-list-check"></i>
                                Disponível como adicional para:
                            </label>
                            <div class="category-chips">
                                <!-- Categorias para adicionais serão carregadas dinamicamente -->
                            </div>
                        </div>

                        <!-- Pré-visualização da Imagem -->
                        <div class="form-group" id="previewContainer">
                            <label class="form-label">
                                <i class="fas fa-photo-video"></i>
                                Pré-visualização
                            </label>
                            <div class="image-preview" id="imagePreview">
                                <div class="preview-placeholder">
                                    <i class="fas fa-image"></i>
                                    <p>Nenhuma imagem selecionada</p>
                                    <small>URL válida mostrará a imagem aqui</small>
                                </div>
                            </div>
                        </div>

                        <!-- Botões de Ação -->
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" id="limparForm">
                                <i class="fas fa-times"></i>
                                Limpar
                            </button>
                            <button type="submit" class="btn-primary" id="submitBtn">
                                <i class="fas fa-check"></i>
                                Cadastrar Produto
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Painel de Produtos -->
                <aside class="products-panel" id="productsPanel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <h2><i class="fas fa-boxes"></i> Produtos Cadastrados</h2>
                            <p class="panel-subtitle" id="panelSubtitle">Total: <span id="totalExibidos">0</span> produtos</p>
                        </div>
                        
                        <div class="panel-filters">
                            <div class="filter-group">
                                <div class="filter-label">
                                    <i class="fas fa-filter"></i>
                                    Filtros:
                                </div>
                                <div class="filter-tags">
                                    <button class="filter-tag active" data-filter="todos">
                                        Todos
                                    </button>
                                    <button class="filter-tag" data-filter="on">
                                        Ativos
                                    </button>
                                    <button class="filter-tag" data-filter="off">
                                        Inativos
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="products-container">
                        <div class="products-grid" id="produtosLista">
                            <!-- Produtos serão carregados aqui -->
                        </div>

                        <div class="loading-state" id="loadingProdutos">
                            <div class="spinner">
                                <div class="spinner-circle"></div>
                            </div>
                            <p>Carregando produtos...</p>
                        </div>
                    </div>

                    <div class="panel-footer">
                        <div class="footer-info">
                            <span id="infoText">Mostrando os últimos produtos cadastrados</span>
                        </div>
                        <button class="btn-view-all" id="btnVerTodos">
                            <i class="fas fa-list"></i>
                            Ver Todos
                        </button>
                    </div>
                </aside>
            </div>
        </main>

        <!-- Notificação Toast -->
        <div class="toast-container" id="toastContainer"></div>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    
    <!-- Script do Aplicativo -->
    <script src="cadprodutos.js"></script>
</body>
</html>